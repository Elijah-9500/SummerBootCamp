<!-- 📝 Save this as index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Elijah Rattray Fun Site</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 20px;
    }
    header, footer {
      text-align: center;
      margin-bottom: 20px;
    }
    .card {
      border: 1px solid #ccc;
      padding: 15px;
      margin: 10px 0;
    }
    canvas {
      border: 1px solid #aaa;
    }
    img#hammer, img#movableCoin {
      z-index: 9999;
    }
  </style>
</head>
<body>

  <header>
    <h1 style="color: #ff00ea; font-style: italic;">Elijah Rattray</h1>
    <ul>
      <li><a href="./index.html">Home</a></li>
      <li><a href="./pages/about.html">ABOUT ME</a></li>
    </ul>
  </header>

  <main>
    <div class="card">
      <section id="counter-section">
        <h2>Counter</h2>
        <p id="counter">0</p>
        <button id="downBtn">Down</button>
        <button id="upBtn">Up</button>
      </section>
    </div>

    <div class="card">
      <h2>Ping Pong Game</h2>
      <canvas id="pingPongCanvas" width="400" height="200"></canvas>
    </div>

    <div class="card" id="siloCard">
      <h2>Missile Launcher</h2>
      <canvas id="turretCanvas" width="400" height="200"></canvas><br>
      <button id="fireMissileBtn">Fire Missile</button>
    </div>
  </main>

  <footer>
    <div>
      <p>Follow me on:</p>
      <a href="https://www.facebook.com/" target="_blank">
        <img src="./images/icons8-facebook-48.png" alt="facebook" />
      </a>
      <a href="https://github.com/Anuken/MindustryBuilds" target="_blank">
        <img src="./images/icons8-github-48.png" alt="github" />
      </a>
    </div>
  </footer>

  <script>
    // === STATE ===
    let counterValue = 0;
    let hammerSpawned = false;
    let siloDestroyed = false;
    let coinRevealed = false;
    let youWinShown = false;

    let missileLaunched = false;

    // === COUNTER ===
    function initCounter() {
      const counterEl = document.getElementById('counter');
      const downBtn = document.getElementById('downBtn');
      const upBtn = document.getElementById('upBtn');
      const counterTitle = document.querySelector('#counter-section h2');

      function updateDisplay() {
        counterEl.textContent = counterValue;
      }

      downBtn.onclick = () => { counterValue--; updateDisplay(); };
      upBtn.onclick = () => { counterValue++; updateDisplay(); };

      counterTitle.onclick = () => {
        if (counterValue === -13 && !hammerSpawned) spawnHammer();
      };

      updateDisplay();
    }

    function spawnHammer() {
      hammerSpawned = true;
      const hammer = document.createElement('img');
      hammer.src = './images/hammer.png';
      hammer.alt = 'Hammer';
      hammer.id = 'hammer';
      hammer.style.position = 'absolute';
      hammer.style.width = '40px';
      hammer.style.left = '60px';
      hammer.style.top = '300px';
      hammer.style.cursor = 'grab';
      document.body.appendChild(hammer);
      enableDrag(hammer);
    }

    function enableDrag(elem) {
      let offsetX, offsetY;
      elem.onmousedown = function (e) {
        offsetX = e.clientX - elem.offsetLeft;
        offsetY = e.clientY - elem.offsetTop;
        document.onmousemove = function (e) {
          elem.style.left = e.clientX - offsetX + 'px';
          elem.style.top = e.clientY - offsetY + 'px';
          checkHammerCollision(elem);
        };
        document.onmouseup = () => {
          document.onmousemove = null;
          document.onmouseup = null;
        };
      };
    }

    // === PING PONG GAME ===
    let pongCanvas, pongCtx;
    let ballX = 200, ballY = 100, ballDx = 2, ballDy = -2;
    let ballRadius = 10;
    let paddleX = 162, paddleWidth = 75, paddleHeight = 10;
    let rightPressed = false, leftPressed = false;

    function initPingPong() {
      pongCanvas = document.getElementById("pingPongCanvas");
      pongCtx = pongCanvas.getContext("2d");

      document.addEventListener("keydown", (e) => {
        if (e.key === "Right" || e.key === "ArrowRight") rightPressed = true;
        if (e.key === "Left" || e.key === "ArrowLeft") leftPressed = true;
      });
      document.addEventListener("keyup", (e) => {
        if (e.key === "Right" || e.key === "ArrowRight") rightPressed = false;
        if (e.key === "Left" || e.key === "ArrowLeft") leftPressed = false;
      });

      function drawPaddle() {
        pongCtx.beginPath();
        pongCtx.rect(paddleX, pongCanvas.height - paddleHeight, paddleWidth, paddleHeight);
        pongCtx.fillStyle = "#000";
        pongCtx.fill();
        pongCtx.closePath();
      }

      function drawBall() {
        pongCtx.beginPath();
        pongCtx.arc(ballX, ballY, ballRadius, 0, Math.PI * 2);
        pongCtx.fillStyle = "#000";
        pongCtx.fill();
        pongCtx.closePath();
      }

      function gameLoop() {
        pongCtx.clearRect(0, 0, pongCanvas.width, pongCanvas.height);

        if (!youWinShown) {
          drawBall();
        }

        drawPaddle();

        if (rightPressed && paddleX < pongCanvas.width - paddleWidth) paddleX += 5;
        else if (leftPressed && paddleX > 0) paddleX -= 5;

        if (!youWinShown) {
          ballX += ballDx;
          ballY += ballDy;

          if (ballX + ballDx > pongCanvas.width - ballRadius || ballX + ballDx < ballRadius) {
            ballDx = -ballDx;
          }

          if (ballY + ballDy < ballRadius) {
            ballDy = -ballDy;
          } else if (ballY + ballDy > pongCanvas.height - ballRadius) {
            if (ballX > paddleX && ballX < paddleX + paddleWidth) {
              ballDy = -ballDy;
            }
          }
        }

        requestAnimationFrame(gameLoop);
      }

      gameLoop();
    }

    function triggerYouWin() {
      youWinShown = true;
      pongCtx.clearRect(0, 0, pongCanvas.width, pongCanvas.height);
      pongCtx.font = "24px Roboto";
      pongCtx.fillStyle = "green";
      pongCtx.fillText("YOU WIN!", 140, 100);
    }

    // === MISSILE & SILO ===
    const turretCanvas = document.getElementById("turretCanvas");
    const turretCtx = turretCanvas.getContext("2d");

    const silo = { x: 180, y: 160, width: 40, height: 40 };

    function drawSilo() {
      if (!siloDestroyed) {
        turretCtx.fillStyle = "black";
        turretCtx.fillRect(silo.x, silo.y, silo.width, silo.height);
      }
    }

    function checkHammerCollision(hammer) {
      const hammerRect = hammer.getBoundingClientRect();
      const turretRect = turretCanvas.getBoundingClientRect();

      const hammerCenter = {
        x: hammerRect.left + hammerRect.width / 2,
        y: hammerRect.top + hammerRect.height / 2,
      };

      const siloAbs = {
        x: turretRect.left + silo.x,
        y: turretRect.top + silo.y,
        width: silo.width,
        height: silo.height,
      };

      if (
        hammerCenter.x > siloAbs.x &&
        hammerCenter.x < siloAbs.x + siloAbs.width &&
        hammerCenter.y > siloAbs.y &&
        hammerCenter.y < siloAbs.y + siloAbs.height &&
        !siloDestroyed
      ) {
        destroySilo();
      }
    }

    function destroySilo() {
      siloDestroyed = true;
      document.getElementById('fireMissileBtn').disabled = true;
      turretCtx.clearRect(silo.x, silo.y, silo.width, silo.height);
      revealMovableCoin(silo.x, silo.y);
    }

    function revealMovableCoin(x, y) {
      if (coinRevealed) return;
      coinRevealed = true;
      const coin = document.createElement("img");
      coin.src = "./images/coin.png";
      coin.id = "movableCoin";
      coin.style.width = "30px";
      coin.style.position = "absolute";
      coin.style.cursor = "grab";

      const rect = turretCanvas.getBoundingClientRect();
      coin.style.left = rect.left + x + "px";
      coin.style.top = rect.top + y + "px";
      document.body.appendChild(coin);

      enableDrag(coin);

      setInterval(() => {
        const coinTop = parseInt(coin.style.top);
        const gameTop = pongCanvas.getBoundingClientRect().top;
        if (coinTop < gameTop + 100 && !youWinShown) {
          triggerYouWin();
        }
      }, 200);
    }

    function initMissileLauncher() {
      drawSilo();

      document.getElementById("fireMissileBtn").onclick = () => {
        if (siloDestroyed || missileLaunched) return;
        missileLaunched = true;

        let missile = { x: 200, y: 190, width: 10, height: 20, speed: 2, angle: 0 };

        function updateMissile() {
          turretCtx.clearRect(0, 0, turretCanvas.width, turretCanvas.height);
          drawSilo();

          // Track pong
          const targetX = ballX;
          const dx = targetX - missile.x;
          const dy = ballY - missile.y;
          const desiredAngle = Math.atan2(dy, dx);

          // Max turn speed
          const delta = ((desiredAngle - missile.angle + Math.PI * 3) % (Math.PI * 2)) - Math.PI;
          const turnSpeed = 0.05;
          missile.angle += Math.sign(delta) * Math.min(turnSpeed, Math.abs(delta));

          missile.x += Math.cos(missile.angle) * missile.speed;
          missile.y += Math.sin(missile.angle) * missile.speed;

          turretCtx.save();
          turretCtx.translate(missile.x, missile.y);
          turretCtx.rotate(missile.angle);
          turretCtx.fillStyle = "#F00";
          turretCtx.fillRect(-5, -10, 10, 20);
          turretCtx.restore();

          if (missile.y < 0 || missile.y > turretCanvas.height) {
            missileLaunched = false;
          } else {
            requestAnimationFrame(updateMissile);
          }
        }

        updateMissile();
      };
    }

    // === INIT ===
    document.addEventListener("DOMContentLoaded", () => {
      initCounter();
      initPingPong();
      initMissileLauncher();
    });
  </script>
</body>
</html>
