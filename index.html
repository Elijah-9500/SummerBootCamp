<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Landing page for Elijah Rattray Fun Site"/>
  <title>Summer Bootcamp Template</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"/>
  <link rel="stylesheet" href="./styles/style.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700&display=swap" rel="stylesheet"/>
</head>
<body>
  <header>
    <h1 style="color: #ff00ea; font-style: italic;">Elijah Rattray</h1>
    <ul>
      <li><a href="./index.html">Home</a></li>
      <li><a href="./pages/about.html">ABOUT ME</a></li>
    </ul>
  </header>

  <main>
    <img src="./images/me.jpg" alt="homepagesmoothie" id="me" />

    <div class="content">
      <!-- Card 1: Counter -->
      <div class="card">
        <section id="counter-section">
          <h2>Counter</h2>
          <p id="counter">0</p>
          <button id="downBtn">Down</button>
          <button id="upBtn">Up</button>
        </section>
      </div>

      <!-- Card 2: Ping Pong -->
      <div class="card">
        <h2>Ping Pong Game</h2>
        <canvas id="pingPongCanvas" width="400" height="200">Canvas not supported</canvas>
      </div>

      <!-- Card 3: Turret Shooting -->
      <div class="card" id="siloCard">
        <h2>Missile Launcher</h2>
        <button id="fireMissileBtn">Fire Missile</button>
        <canvas id="turretCanvas" width="400" height="200">Canvas not supported</canvas>
      </div>
    </div>
  </main>

  <footer>
    <div class="gitHub">
      <b>GitHub</b>
      <p><a href="">My GitHub</a></p>
    </div>
    <div class="my_information">
      <p>Social Media</p><br />
      <a href="https://www.facebook.com/" target="_blank"><img src="./images/icons8-facebook-48.png" alt="facebook" /></a>
      <a href="https://github.com/Anuken/MindustryBuilds?tab=readme-ov-file#readme" target="_blank"><img src="./images/icons8-github-48.png" alt="github" /></a>
    </div>
  </footer>

  <script>
    // Game state variables
    let counterValue = 0;
    let hammerSpawned = false;
    let siloDestroyed = false;
    let coinRevealed = false;
    let youWinShown = false;

    let missileLaunched = false;
    let pongBallDestroyed = false;

    // Counter Initialization
    function initCounter() {
      const counterEl = document.getElementById('counter');
      const downBtn = document.getElementById('downBtn');
      const upBtn = document.getElementById('upBtn');
      const counterTitle = document.querySelector('#counter-section h2');

      function updateDisplay() {
        counterEl.textContent = counterValue;
      }

      downBtn.addEventListener('click', () => {
        counterValue--;
        updateDisplay();
      });

      upBtn.addEventListener('click', () => {
        counterValue++;
        updateDisplay();
      });

      counterTitle.addEventListener('click', () => {
        if (counterValue === -13 && !hammerSpawned) {
          spawnHammer();
        }
      });

      updateDisplay();
    }

    function spawnHammer() {
      hammerSpawned = true;
      const hammer = document.createElement('img');
      hammer.src = './images/hammer.png';
      hammer.alt = 'Hammer';
      hammer.id = 'hammer';
      hammer.style.width = '40px';
      hammer.style.position = 'absolute';
      hammer.style.cursor = 'grab';
      hammer.style.left = '50px';
      hammer.style.top = '300px';
      document.body.appendChild(hammer);

      enableDrag(hammer);
    }

    function enableDrag(elem) {
      let offsetX, offsetY;

      elem.onmousedown = function (e) {
        offsetX = e.clientX - elem.offsetLeft;
        offsetY = e.clientY - elem.offsetTop;

        document.onmousemove = function (e) {
          elem.style.left = e.clientX - offsetX + 'px';
          elem.style.top = e.clientY - offsetY + 'px';
          checkHammerCollisionWithSilo(elem);
        };

        document.onmouseup = function () {
          document.onmousemove = null;
          document.onmouseup = null;
        };
      };
    }

    function checkHammerCollisionWithSilo(hammer) {
      const silo = document.getElementById('siloCard');
      const rect1 = hammer.getBoundingClientRect();
      const rect2 = silo.getBoundingClientRect();

      const overlap = !(rect1.right < rect2.left ||
                        rect1.left > rect2.right ||
                        rect1.bottom < rect2.top ||
                        rect1.top > rect2.bottom);

      if (overlap && !siloDestroyed) {
        destroySilo();
      }
    }

    function destroySilo() {
      siloDestroyed = true;
      const btn = document.getElementById('fireMissileBtn');
      btn.disabled = true;
      btn.textContent = 'Silo Destroyed';
      revealMovableCoin();
    }

    function revealMovableCoin() {
      if (coinRevealed) return;
      coinRevealed = true;

      const coin = document.createElement('img');
      coin.src = './images/coin.png';
      coin.alt = 'Coin';
      coin.id = 'movableCoin';
      coin.style.width = '30px';
      coin.style.position = 'absolute';
      coin.style.cursor = 'grab';
      coin.style.left = '500px';
      coin.style.top = '600px';
      document.body.appendChild(coin);

      enableDragCoin(coin);
    }

    function enableDragCoin(elem) {
      let offsetX, offsetY;

      elem.onmousedown = function (e) {
        offsetX = e.clientX - elem.offsetLeft;
        offsetY = e.clientY - elem.offsetTop;

        document.onmousemove = function (e) {
          elem.style.left = e.clientX - offsetX + 'px';
          elem.style.top = e.clientY - offsetY + 'px';
          checkCoinPositionForPongTrigger(elem);
        };

        document.onmouseup = function () {
          document.onmousemove = null;
          document.onmouseup = null;
        };
      };
    }

    function checkCoinPositionForPongTrigger(coin) {
      const canvas = document.getElementById("pingPongCanvas");
      const canvasRect = canvas.getBoundingClientRect();
      const coinRect = coin.getBoundingClientRect();

      const coinCenterY = (coinRect.top + coinRect.bottom) / 2;

      if (coinCenterY < canvasRect.top + canvas.height / 2 && !youWinShown) {
        youWinShown = true;
        pausePongAndCollectCoin();
      }
    }

    // PONG GAME
    let ballRadius = 10;
    let ballX, ballY, ballDx, ballDy;
    let paddleHeight = 10, paddleWidth = 75, paddleX;
    let rightPressed = false, leftPressed = false;

    function initPingPong() {
      const canvas = document.getElementById("pingPongCanvas");
      const ctx = canvas.getContext("2d");

      function resetBall() {
        ballX = canvas.width / 2;
        ballY = canvas.height / 2;
        ballDx = 2;
        ballDy = -2;
        paddleX = (canvas.width - paddleWidth) / 2;
        pongBallDestroyed = false;
      }

      resetBall();

      document.addEventListener("keydown", (e) => {
        if (e.key === "Right" || e.key === "ArrowRight") rightPressed = true;
        if (e.key === "Left" || e.key === "ArrowLeft") leftPressed = true;
      });

      document.addEventListener("keyup", (e) => {
        if (e.key === "Right" || e.key === "ArrowRight") rightPressed = false;
        if (e.key === "Left" || e.key === "ArrowLeft") leftPressed = false;
      });

      function drawPaddle() {
        ctx.beginPath();
        ctx.rect(paddleX, canvas.height - paddleHeight, paddleWidth, paddleHeight);
        ctx.fillStyle = "#000";
        ctx.fill();
        ctx.closePath();
      }

      function drawBall() {
        ctx.beginPath();
        ctx.arc(ballX, ballY, ballRadius, 0, Math.PI * 2);
        ctx.fillStyle = "#000";
        ctx.fill();
        ctx.closePath();
      }

      function updateGame() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        if (!youWinShown) {
          drawBall();
        }

        drawPaddle();

        if (rightPressed && paddleX < canvas.width - paddleWidth) {
          paddleX += 5;
        } else if (leftPressed && paddleX > 0) {
          paddleX -= 5;
        }

        if (!pongBallDestroyed && !youWinShown) {
          ballX += ballDx;
          ballY += ballDy;

          if (ballX + ballDx > canvas.width - ballRadius || ballX + ballDx < ballRadius) {
            ballDx = -ballDx;
          }

          if (ballY + ballDy < ballRadius) {
            ballDy = -ballDy;
          } else if (ballY + ballDy > canvas.height - ballRadius) {
            if (ballX > paddleX && ballX < paddleX + paddleWidth) {
              ballDy = -ballDy;
            } else {
              pongBallDestroyed = true;
              setTimeout(resetBall, 3000);
            }
          }
        }

        requestAnimationFrame(updateGame);
      }

      updateGame();
    }

    function pausePongAndCollectCoin() {
      setTimeout(() => {
        ballDx = 0;
        ballDy = 0;

        const coin = document.getElementById('movableCoin');
        const rect = coin.getBoundingClientRect();
        ballX = rect.left + 15;
        ballY = rect.top + 15;

        const canvas = document.getElementById("pingPongCanvas");
        const ctx = canvas.getContext("2d");

        let riseInterval = setInterval(() => {
          const canvasRect = canvas.getBoundingClientRect();
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          drawPaddle();
          ctx.beginPath();
          ctx.arc(ballX - canvasRect.left, ballY - canvasRect.top, ballRadius, 0, Math.PI * 2);
          ctx.fillStyle = "#000";
          ctx.fill();
          ctx.closePath();

          ballY -= 2;
          if (ballY < canvasRect.top) {
            clearInterval(riseInterval);
            showWinMessage();
          }
        }, 16);
      }, 1000);
    }

    function showWinMessage() {
      const canvas = document.getElementById("pingPongCanvas");
      const ctx = canvas.getContext("2d");

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.font = "24px Roboto";
      ctx.fillStyle = "#00AA00";
      ctx.fillText("YOU WIN!", canvas.width / 2 - 60, canvas.height / 2);
    }

    // Missile Launcher
    function initMissileLauncher() {
      const fireBtn = document.getElementById("fireMissileBtn");
      const canvas = document.getElementById("turretCanvas");
      const ctx = canvas.getContext("2d");

      fireBtn.addEventListener("click", () => {
        if (siloDestroyed || missileLaunched) return;

        missileLaunched = true;
        let missile = { x: 200, y: 190, width: 10, height: 20, dy: -2 };

        function animateMissile() {
          if (!missileLaunched) return;
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.beginPath();
          ctx.rect(missile.x, missile.y, missile.width, missile.height);
          ctx.fillStyle = "#FF0000";
          ctx.fill();
          ctx.closePath();

          missile.y += missile.dy;

          if (missile.y <= 0) {
            missileLaunched = false;
          } else {
            requestAnimationFrame(animateMissile);
          }
        }

        animateMissile();
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      initCounter();
      initPingPong();
      initMissileLauncher();
    });
  </script>
</body>
</html>
